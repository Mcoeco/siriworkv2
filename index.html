<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, sans-serif;
      background: #f4f6f9;
      margin: 0;
      padding: 0;
    }

    header {
      background: linear-gradient(90deg, #1e3c72, #2a5298);
      color: white;
      padding: 12px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      font-size: 20px;
      margin: 0;
    }

    .toolbar {
      display: flex;
      gap: 10px;
    }

    .btn {
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }
    .btn-primary { background: #007bff; color: white; }
    .btn-danger { background: #dc3545; color: white; }
    .btn-secondary { background: #6c757d; color: white; }
    .btn-success { background: #28a745; color: white; }

    .document-card {
      background: white;
      border-radius: 10px;
      padding: 15px;
      margin: 12px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .document-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .document-number {
      font-weight: bold;
      color: #2a5298;
    }

    .status-badge {
      padding: 2px 8px;
      border-radius: 5px;
      font-size: 12px;
      color: white;
    }
    .status-received { background: #28a745; }
    .status-sent { background: #ff9800; }

    .detail-item {
      margin: 4px 0;
    }

    /* === Modal === */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.4);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      width: 400px;
      max-width: 90%;
    }
    .modal h3 { margin-top: 0; }
    .modal input, .modal select {
      width: 100%;
      margin-bottom: 10px;
      padding: 6px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    .checkbox-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 15px;
    }
  </style>
</head>
<body>

  <header>
    <h1>üìë ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</h1>
    <div class="toolbar">
      <button class="btn btn-success" onclick="openExportModal()">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å</button>
    </div>
  </header>

  <main id="document-list"></main>

  <!-- Modal ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <h3>‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h3>
      <form id="editForm">
        <input type="hidden" id="editId">
        <label>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
        <input type="text" id="editDocNumber" required>
        <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
        <input type="date" id="editDate" required>
        <label>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
        <input type="text" id="editOrg" required>
        <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
        <select id="editType">
          <option value="received">‡∏£‡∏±‡∏ö</option>
          <option value="sent">‡∏™‡πà‡∏á</option>
        </select>
        <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</label>
        <input type="text" id="editDocType">
        <label>‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</label>
        <input type="text" id="editSubject" required>
        <div style="text-align:right; margin-top:10px;">
          <button type="button" class="btn btn-secondary" onclick="closeEditModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="submit" class="btn btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å -->
  <div id="exportModal" class="modal">
    <div class="modal-content">
      <h3>üì§ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
      <div class="checkbox-list">
        <label><input type="checkbox" value="json"> JSON</label>
        <label><input type="checkbox" value="html"> HTML</label>
        <label><input type="checkbox" value="excel"> Excel (CSV)</label>
        <label><input type="checkbox" value="pdf"> PDF</label>
        <label><input type="checkbox" value="word"> Word (DOC)</label>
        <label><input type="checkbox" value="print"> ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
      </div>
      <div style="text-align:right;">
        <button class="btn btn-secondary" onclick="closeExportModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        <button class="btn btn-success" onclick="doExport()">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å</button>
      </div>
    </div>
  </div>

  <script>
    let documents = [
      {id:1, type:"received", doc_number:"‡∏ô.001/2567", document_date:"2024-12-01", organization:"‡∏ú‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡πà‡∏≤‡∏ô", doc_type:"‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å", subject:"‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö 1"},
      {id:2, type:"sent", doc_number:"‡∏™.002/2567", document_date:"2024-12-05", organization:"‡∏Å‡∏£‡∏∞‡∏ó‡∏£‡∏ß‡∏á‡∏°‡∏´‡∏≤‡∏î‡πÑ‡∏ó‡∏¢", doc_type:"‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏†‡∏≤‡∏¢‡πÉ‡∏ô", subject:"‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö 2"}
    ];

    function renderDocuments() {
      const list = document.getElementById("document-list");
      list.innerHTML = documents.map(doc => `
        <div class="document-card">
          <div class="document-header">
            <div class="document-number">${doc.doc_number}</div>
            <div class="status-badge ${doc.type === 'received' ? 'status-received' : 'status-sent'}">
              ${doc.type === 'received' ? 'üì• ‡∏£‡∏±‡∏ö' : 'üì§ ‡∏™‡πà‡∏á'}
            </div>
            <div>
              <button class="btn btn-primary" onclick="openEditModal(${doc.id})">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
              <button class="btn btn-danger" onclick="deleteDocument(${doc.id})">üóëÔ∏è ‡∏•‡∏ö</button>
            </div>
          </div>
          <div class="detail-item"><b>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</b> ${new Date(doc.document_date).toLocaleDateString('th-TH')}</div>
          <div class="detail-item"><b>${doc.type === 'received' ? '‡∏à‡∏≤‡∏Å' : '‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á'}:</b> ${doc.organization}</div>
          <div class="detail-item"><b>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</b> ${doc.doc_type}</div>
          <div class="detail-item"><b>‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á:</b> ${doc.subject}</div>
        </div>
      `).join("");
    }

    // === Modal ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ===
    function openEditModal(id) {
      const doc = documents.find(d => d.id === id);
      if (!doc) return;
      document.getElementById("editId").value = doc.id;
      document.getElementById("editDocNumber").value = doc.doc_number;
      document.getElementById("editDate").value = doc.document_date;
      document.getElementById("editOrg").value = doc.organization;
      document.getElementById("editType").value = doc.type;
      document.getElementById("editDocType").value = doc.doc_type;
      document.getElementById("editSubject").value = doc.subject;
      document.getElementById("editModal").style.display = "flex";
    }
    function closeEditModal() {
      document.getElementById("editModal").style.display = "none";
    }
    document.getElementById("editForm").onsubmit = function(e) {
      e.preventDefault();
      const id = parseInt(document.getElementById("editId").value);
      const index = documents.findIndex(d => d.id === id);
      documents[index] = {
        id,
        doc_number: document.getElementById("editDocNumber").value,
        document_date: document.getElementById("editDate").value,
        organization: document.getElementById("editOrg").value,
        type: document.getElementById("editType").value,
        doc_type: document.getElementById("editDocType").value,
        subject: document.getElementById("editSubject").value,
      };
      closeEditModal();
      renderDocuments();
    };

    // === Modal ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å ===
    function openExportModal() {
      document.getElementById("exportModal").style.display = "flex";
    }
    function closeExportModal() {
      document.getElementById("exportModal").style.display = "none";
    }
    function doExport() {
      const checkboxes = document.querySelectorAll("#exportModal input[type=checkbox]:checked");
      const formats = Array.from(checkboxes).map(cb => cb.value);
      closeExportModal();

      formats.forEach(f => {
        if (f === "json") {
          const blob = new Blob([JSON.stringify(documents, null, 2)], { type: "application/json" });
          downloadFile(blob, "documents.json");
        }
        if (f === "html") {
          let html = "<html><body><h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h2><ul>";
          documents.forEach(d => { html += `<li>${d.doc_number} - ${d.subject} (${d.organization})</li>`; });
          html += "</ul></body></html>";
          const blob = new Blob([html], { type: "text/html" });
          downloadFile(blob, "documents.html");
        }
        if (f === "excel") {
          const csv = documents.map(d => `${d.doc_number},${d.subject},${d.organization}`).join("\n");
          const blob = new Blob([csv], { type: "text/csv" });
          downloadFile(blob, "documents.csv");
        }
        if (f === "pdf") {
          const content = documents.map(d => `${d.doc_number} - ${d.subject}`).join("\n");
          const blob = new Blob([content], { type: "application/pdf" });
          downloadFile(blob, "documents.pdf");
        }
        if (f === "word") {
          const content = documents.map(d => `${d.doc_number} - ${d.subject}`).join("\n");
          const blob = new Blob([content], { type: "application/msword" });
          downloadFile(blob, "documents.doc");
        }
        if (f === "print") {
          const w = window.open("", "", "width=800,height=600");
          w.document.write("<h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h2><ul>");
          documents.forEach(d => { w.document.write(`<li>${d.doc_number} - ${d.subject} (${d.organization})</li>`); });
          w.document.write("</ul>");
          w.print();
        }
      });
    }

    function downloadFile(blob, filename) {
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = filename;
      a.click();
      URL.revokeObjectURL(url);
    }

    function deleteDocument(id) {
      documents = documents.filter(d => d.id !== id);
      renderDocuments();
    }

    renderDocuments();
  </script>

</body>
</html>
